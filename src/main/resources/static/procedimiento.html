<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SUCODER - Java Code Generator</title>

  <link rel="stylesheet" type="text/css" href="/css/style.css">
  <link rel="stylesheet" href="css/bootstrap.min.css">

</head>
<body>

<header>
  <a href="index.html">
    <img src="images/SUCODER2.png" alt="SUCODER Logo" style="height: 105px;">
  </a>
  <nav class="navbar">
    <a href="index.html">Inicio</a>
    <a href="procedimiento.html">Crear Procedimiento</a>
    <a href="codigo.html">Crear Código</a>
  </nav>
</header>

<br><br><br><br><br><br>

<div class="container">
  <div class="box">
    <div>
      <form id="codeGeneratorForm">
          <h2 align="center">Crear Procedimiento</h2>
        <br><br><br>

          <h4>Nombre Procedimiento</h4>
          <div class="input-box">
            <input type="text" id="procedureName" name="procedureName" onkeyup="updateTextArea()" required autocomplete="off">
          </div><br><br>

        <div class="button-container">
          <button class="button-64" type="button" style="margin-right: 10px; margin-left: 10px;" data-bs-toggle="modal" data-bs-target="#variablesModal"><span class="text">VARIABLES</span></button>
          <button class="button-64" type="button" data-bs-toggle="modal" data-bs-target="#siModal"><span class="text">SI</span></button>
          <button class="button-64" type="button" data-bs-toggle="modal" data-bs-target="#mientrasModal"><span class="text">MIENTRAS</span></button>
        </div><br>
        <div class="button-container">
          <button class="button-64" type="button" data-bs-toggle="modal" data-bs-target="#imprimirModal"><span class="text">IMPRIMIR</span></button>
          <button class="button-64" type="button" data-bs-toggle="modal" data-bs-target="#comentarModal"><span class="text">COMENTARIO</span></button>
        </div><br><br>

          <!-- Variables Modal -->
          <div class="modal fade" id="variablesModal" tabindex="-1" role="dialog" aria-labelledby="variablesModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content" style="background-color: black; border: .2rem solid #fff;">
                <div class="modal-header" style="color: white;">
                  <h5 class="modal-title" id="variablesModalLabel">Variables</h5>
                  <button type="button" class="custom-close-button" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div><br>
                <div class="modal-body">
                  <form>
                    <div class="input-name">
                      <label for="variableNombre" style="color: white;">Nombre:</label>
                      <input type="text" id="variableNombre" name="variableNombre" required>
                    </div><br>
                    <div class="input-type">
                      <label for="variableTipo" style="color: white;">Tipo:</label>
                      <select id="variableTipo" name="variableTipo" style="height: 90px" required>
                        <option value="int" style="background-color: rgba(0, 0, 0, 0.8);">Número (int)</option>
                        <option value="double" style="background-color: rgba(0, 0, 0, 0.8);">Número decimal (double)</option>
                        <option value="String" style="background-color: rgba(0, 0, 0, 0.8);">Texto (String)</option>
                      </select>
                    </div><br>
                    <div class="input-value">
                      <label for="variableValor" style="color: white;">Valor:</label>
                      <input type="text" id="variableValor" name="variableValor" required>
                    </div><br>
                    <div class="button-charge">
                      <button id="cargarVariablesBtn" class="button-63" type="button">Cargar Variables</button>
                    </div><br>
                    <div class="textarea-charge">
                      <label for="variablesCargados" style="color: white;">Variables Cargados:</label>
                      <textarea id="variablesCargados" readonly></textarea>
                    </div>

                  </form>
                </div><br>
                <div class="modal-footer">
                  <button id="guardarVariablesBtn" type="button" class="button">Guardar Variables</button>
                </div>
              </div>
            </div>
          </div>

          <!-- SI Modal -->
          <div class="modal fade" id="siModal" tabindex="-1" role="dialog" aria-labelledby="siModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content" style="background-color: black; border: .2rem solid #fff;">
                <div class="modal-header">
                  <h5 class="modal-title" id="siModalLabel" style="color: white;">SI</h5>
                  <button type="button" class="custom-close-button" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div><br>
                <div class="modal-body">
                  <div class="attribute1">
                    <label for="attribute1" style="color: white;">Variable 1</label>
                    <select id="attribute1" name="attribute1" style="height: 90px">
                      <option value="-" style="background-color: rgba(0, 0, 0, 0.8);">-</option>
                    </select>
                  </div><br>
                  <div class="attribute2">
                    <label for="attribute2" style="color: white;">Variable 2</label>
                    <select id="attribute2" name="attribute2" style="height: 90px">
                      <option value="-" style="background-color: rgba(0, 0, 0, 0.8);">-</option>
                    </select>
                  </div><br>
                  <div class="operator">
                    <label for="comparisonOperation" style="color: white;">Operador de Comparación</label>
                    <select id="comparisonOperation" name="comparisonOperation" style="height: 90px">
                      <option value="==" style="background-color: rgba(0, 0, 0, 0.8);">Igual (==)</option>
                      <option value="!=" style="background-color: rgba(0, 0, 0, 0.8);">Distinto (!=)</option>
                      <option value=">" style="background-color: rgba(0, 0, 0, 0.8);">Es Mayor (>)</option>
                      <option value="<" style="background-color: rgba(0, 0, 0, 0.8);">Es Menor (<)</option>
                      <option value=">=" style="background-color: rgba(0, 0, 0, 0.8);">Mayor o Igual (>=)</option>
                      <option value="<=" style="background-color: rgba(0, 0, 0, 0.8);">Menor o Igual (<=)</option>
                    </select>
                  </div>
                </div><br>
                <div class="modal-footer">
                  <button class="button" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal" data-bs-dismiss="modal">Siguiente</button>
                </div>
              </div>
            </div>
          </div>
          <div class="modal fade" id="exampleModalToggle2" aria-hidden="true" aria-labelledby="exampleModalToggleLabel2" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content" style="background-color: black; border: .2rem solid #fff;">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalToggleLabel2" style="color: white;">Condiciones</h5>
                  <button type="button" class="custom-close-button" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div><br>
                <div class="modal-body">
                  <div class="form-group">
                    <label style="color: white;">Verdadera</label>
                    <button class="button-63" data-bs-target="#modalVerdadero" data-bs-toggle="modal" data-bs-dismiss="modal">IMPRIMIR</button>
                  </div><br>
                  <div class="form-group">
                    <label style="color: white;">Falsa</label>
                    <button class="button-63" data-bs-target="#modalFalso" data-bs-toggle="modal" data-bs-dismiss="modal">IMPRIMIR</button>
                  </div>
                </div><br>
                <div class="modal-footer">
                  <button class="button" style="background: grey;" data-bs-target="#siModal" data-bs-toggle="modal" data-bs-dismiss="modal">Anterior</button>
                  <button class="button" style="background: #fff;" type="button" id="guardarCondicionSiBtn" class="btn btn-primary">Guardar Condición "SI"</button>
                </div>
              </div>
            </div>
          </div>
          <div class="modal fade" id="modalVerdadero" aria-hidden="true" aria-labelledby="modalVerdadero" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content" style="background-color: black; border: .2rem solid #fff;">
                <div class="modal-header">
                  <h5 class="modal-title" style="color: white;">Imprimir Mensaje</h5>
                  <button type="button" class="custom-close-button" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div><br>
                <div class="modal-body">
                  <div class="true_message">
                    <label for="trueConditionStatements" style="color: white;">Mensaje si es Verdadero:</label>
                    <input type="text" id="trueConditionStatements" name="trueConditionStatements" required>
                  </div>
                </div><br>
                <div class="modal-footer">
                  <button class="button" style="background: #fff;" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal" data-bs-dismiss="modal">Aceptar</button>
                </div>
              </div>
            </div>
          </div>

          <div class="modal fade" id="modalFalso" aria-hidden="true" aria-labelledby="modalFalso" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content" style="background-color: black; border: .2rem solid #fff;">
                <div class="modal-header">
                  <h5 class="modal-title" style="color: white;">Imprimir Mensaje</h5>
                  <button type="button" class="custom-close-button" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div><br>
                <div class="modal-body">
                  <div class="false_message">
                    <label for="falseConditionStatements" style="color: white;">Mensaje si es Falso:</label>
                    <input type="text" id="falseConditionStatements" name="falseConditionStatements" required>
                  </div>
                </div><br>
                <div class="modal-footer">
                  <button class="button" style="background: #fff;" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal" data-bs-dismiss="modal">Aceptar</button>
                </div>
              </div>
            </div>
          </div>

          <!-- IMPRIMIR Modal -->
          <div class="modal fade" id="imprimirModal" tabindex="-1" role="dialog" aria-labelledby="imprimirModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content" style="background-color: black; border: .2rem solid #fff;">
                <div class="modal-header">
                  <h5 class="modal-title" id="imprimirModalLabel" style="color: white;">Imprimir Mensaje</h5>
                  <button type="button" class="custom-close-button" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div><br>
                <div class="modal-body">
                  <div class="message">
                    <label for="imprimirMensaje" style="color: white;">Mensaje:</label>
                    <input type="text" id="imprimirMensaje" name="imprimirMensaje" required>
                  </div>
                </div><br>
                <div class="modal-footer">
                  <button id="guardarMensajeButton" type="button" class="button" style="background: #fff;" onclick="saveMessage()">Guardar Mensaje</button>
                </div>
              </div>
            </div>
          </div>

          <!-- MIENTRAS Modal -->
          <div class="modal fade" id="mientrasModal" tabindex="-1" role="dialog" aria-labelledby="mientrasModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content" style="background-color: black; border: .2rem solid #fff;">
                <div class="modal-header">
                  <h5 class="modal-title" id="mientrasModalLabel" style="color: white;">MIENTRAS</h5>
                  <button type="button" class="custom-close-button" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div><br>
                <div class="modal-body">
                  <div class="attribute1-while">
                    <label for="attribute1While" style="color: white;">Variable 1</label>
                    <select id="attribute1While" name="attribute1While" style="height: 90px">
                      <option value="-" style="background-color: rgba(0, 0, 0, 0.8);">-</option>
                    </select>
                  </div><br>
                  <div class="attribute2-while">
                    <label for="attribute2While" style="color: white;">Variable 2</label>
                    <select id="attribute2While" name="attribute2" style="height: 90px">
                      <option value="-" style="background-color: rgba(0, 0, 0, 0.8);">-</option>
                    </select>
                  </div><br>
                  <div class="operator-while">
                    <label for="comparisonOperation2" style="color: white;">Operador de Comparación</label>
                    <select id="comparisonOperation2" name="comparisonOperation2" style="height: 90px">
                      <option value="==" style="background-color: rgba(0, 0, 0, 0.8);">Igual (==)</option>
                      <option value="!=" style="background-color: rgba(0, 0, 0, 0.8);">Distinto (!=)</option>
                      <option value=">" style="background-color: rgba(0, 0, 0, 0.8);">Es Mayor (>)</option>
                      <option value="<" style="background-color: rgba(0, 0, 0, 0.8);">Es Menor (<)</option>
                      <option value=">=" style="background-color: rgba(0, 0, 0, 0.8);">Mayor o Igual (>=)</option>
                      <option value="<=" style="background-color: rgba(0, 0, 0, 0.8);">Menor o Igual (<=)</option>
                    </select>
                  </div>
                </div><br>
                <div class="modal-footer">
                  <button class="button" id="siguienteButton" data-bs-target="#condicionWhileModal" data-bs-toggle="modal" data-bs-dismiss="modal">Siguiente</button>
                </div>
              </div>
            </div>
          </div>
          <div class="modal fade" id="condicionWhileModal" aria-hidden="true" aria-labelledby="condicionWhileModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content" style="background-color: black; border: .2rem solid #fff;">
                <div class="modal-header">
                  <h5 class="modal-title" style="color: white;">Condición</h5>
                  <button type="button" class="custom-close-button" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div><br>
                <div class="modal-body">
                  <div class="form-group">
                    <button class="button-63" data-bs-target="#modalMensajeWhile" data-bs-toggle="modal" data-bs-dismiss="modal">IMPRIMIR</button>
                  </div>
                </div><br>
                <div class="modal-body">
                  <div class="form-group">
                    <button class="button-63" data-bs-target="#modalIncrementDecrement" data-bs-toggle="modal" data-bs-dismiss="modal">INCREMENTO o DESCREMENTO</button>
                  </div>
                </div><br>
                <div class="modal-footer">
                  <button class="button" style="background: grey;" data-bs-target="#mientrasModal" data-bs-toggle="modal" data-bs-dismiss="modal">Anterior</button>
                  <button type="button" id="guardarCondicionWhile" class="button" style="background: #fff;">Guardar Condición "MIENTRAS"</button>
                </div>
              </div>
            </div>
          </div>
          <div class="modal fade" id="modalMensajeWhile" aria-hidden="true" aria-labelledby="modalMensajeWhile" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content" style="background-color: black; border: .2rem solid #fff;">
                <div class="modal-header">
                  <h5 class="modal-title" style="color: white;">Imprimir Mensaje</h5>
                  <button type="button" class="custom-close-button" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div><br>
                <div class="modal-body">
                  <div class="message-while">
                    <label for="messageWhile" style="color: white;">Mensaje:</label>
                    <input type="text" id="messageWhile" name="messageWhile" required>
                  </div>
                </div><br>
                <div class="modal-footer">
                  <button class="button" data-bs-target="#condicionWhileModal" data-bs-toggle="modal" data-bs-dismiss="modal">Aceptar</button>
                </div>
              </div>
            </div>
          </div>
        <div class="modal fade" id="modalIncrementDecrement" tabindex="-1" role="dialog" aria-labelledby="modalIncrementDecrementLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content" style="background-color: black; border: .2rem solid #fff;">
              <div class="modal-header">
                <h5 class="modal-title" id="modalIncrementDecrementLabel" style="color: white;">Definir Incremento o Decremento</h5>
                <button type="button" class="custom-close-button" data-bs-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div><br>
              <div class="modal-body">
                <div class="attribute-dropdown">
                  <label for="attributeDropdown" style="color: white;">Seleccionar Variable:</label>
                  <select id="attributeDropdown" name="attributeDropdown" style="height: 90px">
                    <option value="-" style="background-color: rgba(0, 0, 0, 0.8);">-</option>
                  </select>
                </div><br>
                <div class="increment-decrement-dropdown">
                  <label for="incrementDecrementDropdown" style="color: white;">Seleccionar Incremento/Decremento:</label>
                  <select id="incrementDecrementDropdown" name="incrementDecrementDropdown" style="height: 90px">
                    <option value="++">Incrementar (++)</option>
                    <option value="--">Decrementar (--)</option>
                  </select>
                </div>
              </div><br>
              <div class="modal-footer">
                <button id="aceptarButton" class="button" data-bs-target="#condicionWhileModal" data-bs-toggle="modal" data-bs-dismiss="modal">Aceptar</button>
              </div>
            </div>
          </div>
        </div>

          <!-- COMENTAR Modal -->
          <div class="modal fade" id="comentarModal" tabindex="-1" role="dialog" aria-labelledby="comentarModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content" style="background-color: black; border: .2rem solid #fff;">
                <div class="modal-header">
                  <h5 class="modal-title" id="comentarModalLabel" style="color: white;">Comentario</h5>
                  <button type="button" class="custom-close-button" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div><br>
                <div class="modal-body">
                  <div class="comment">
                    <label for="mensajeComentado" style="color: white;">Mensaje:</label>
                    <input type="text" id="mensajeComentado" name="mensajeComentado" required>
                  </div>
                </div><br>
                <div class="modal-footer">
                  <button type="button" class="button" style="background: #fff;" onclick="saveComment()">Guardar Comentario</button>
                </div>
              </div>
            </div>
          </div>
          <br>
        <div class="textarea_field">
          <textarea id="maintextarea" rows="10" cols="50" style="width: 750px;" readonly></textarea>
        </div>
        <br><br>
          <button id="guardarProcedimiento" type="button" class="button-63">Guardar Procedimiento</button>

      </form>
    </div>
  </div>
</div>
<br><br><br>

<script src="js/bootstrap.min.js"></script>
<script src="/js/sweetalert.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
let componentsOrder = []; // Store the order of selected components

  function updateTextArea() {
    const procedureName = document.getElementById('procedureName').value;
    const formattedProcedure = createJavaProcedure(procedureName, componentsOrder);
    document.getElementById('maintextarea').value = formattedProcedure;
  }

  function createJavaProcedure(procedureName, selectedComponents) {
  let procedureCode = `public void ${procedureName}() {\n`;

  selectedComponents.forEach(component => {
    switch (component) {
      case "variables":
        procedureCode += "// Code for VARIABLES\n";
        procedureCode += createVariablesCode();
        break;
      case "si":
        procedureCode += "// Code for SI\n";
        procedureCode += createSiCode();
        break;
      case "mientras":
        procedureCode += "// Code for MIENTRAS\n";
        procedureCode += createMientrasCode();
        break;
      case "imprimir":
        procedureCode += "// Code for IMPRIMIR\n";
        procedureCode += createImprimirCode();
        break;
      case "comentario":
        procedureCode += "// Code for COMENTARIO\n";
        procedureCode += createComentarioCode();
        break;
      // Add more cases for other components
    }
  });

  procedureCode += "}";
  return procedureCode;

}

</script>

<script src="/js/modal/variablesModal.js"></script>
<script src="/js/modal/siModal.js"></script>
<script src="/js/modal/mientrasModal.js"></script>
<script src="/js/modal/imprimirModal.js"></script>
<script src="/js/modal/comentarioModal.js"></script>

<script>
  document.getElementById("guardarProcedimiento").addEventListener("click", function () {
    const procedureName = document.getElementById("procedureName").value;
    const procedureContent = document.getElementById("maintextarea").value;

    // Combine the procedure name and content into a single string
    const data = `${procedureName}\n${procedureContent}`;

    fetch("/api/procedimientos", {
      method: "POST",
      headers: {
        "Content-Type": "text/plain",
      },
      body: data, // Send the combined data as plain text
    })
      .then((response) => {
        if (!response.ok) {
          throw new Error("Network response was not ok");
        }
        return response.text();
      })
      .then((data) => {
        alert("Procedure saved successfully!");
      })
      .catch((error) => {
        console.error("Error saving procedure:", error);
        alert("An error occurred while saving the procedure.");
      });
  });
</script>

</body>
</html>
